<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.smartpensionspringboot.lbb.dao.DetailStorageDao">
    <resultMap id="DetailStorageMap" type="com.example.smartpensionspringboot.lbb.pojos.DetailStorage">
        <id column="id" property="id"/>
        <result property="tollman" column="tollman"/>
        <result property="charging_time" column="charging_time"/>
        <result property="dexplain" column="dexplain"/>
        <result property="amount" column="amount"/>
        <result property="payment" column="payment"/>
        <result property="remark" column="remark"/>
        <result property="insert_time" column="insert_time"/>
        <result property="update_time" column="update_time"/>
        <result property="delete_time" column="delete_time"/>
    </resultMap>
    <!--获取预存详情信息-->
    <select id="getDetailStorage" resultMap="DetailStorageMap">
        SELECT id,tollman,charging_time,dexplain,payment,amount,remark
        FROM cost_detail_storage
    </select>
    <!--获取某一个老人的预存详情-->
    <select id="getDetailStorageByOldId" resultMap="DetailStorageMap" parameterType="int">
        SELECT cds.tollman,cds.charging_time,cds.dexplain,cds.payment,cds.amount,cds.remark
        FROM cost_detail_storage cds
        LEFT JOIN cost_prestore cp ON cds.id = cp.detail_id
        LEFT JOIN rec_old ro ON cp.old_id = ro.old_id
        where ro.old_id = #{id}
    </select>
    <!--添加预存详情-->
    <insert id="addDetailStorage" parameterType="com.example.smartpensionspringboot.lbb.vo.PrestoreVo" keyColumn="id" keyProperty="id" useGeneratedKeys="true">
        insert into cost_detail_storage(tollman,charging_time,dexplain,payment,amount,remark)
        values (#{tollman},#{charging_time},#{dexplain},#{payment},#{amount},#{remark})
    </insert>
</mapper>